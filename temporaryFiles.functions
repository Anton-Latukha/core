core_usesIn core trap
core_usesIn core/variable array

core_temporaryFiles_initialise()
{
	core_trap_addOnCleanUp core_temporaryFiles_removeAll
}
core_functions_register core_functions core_temporaryFiles_initialise

core_dependency_requires '*' rm
_core_temporaryFiles_removeAll_callback()
{
	rm -r -f -- "$@"
}

core_temporaryFiles_removeAll()
{
	if core_variable_array_isSet _core_temporaryFiles_filesToRemoveOnExit; then
		core_variable_array_passToFunctionAsArguments _core_temporaryFiles_filesToRemoveOnExit _core_temporaryFiles_removeAll_callback
	fi
}

core_dependency_requires '*' mktemp
core_temporaryFiles_newFileToRemoveOnExit()
{
	TMP_FILE="$(mktemp -t "$global_ourName".XXXXXXXXXXXX)"
	core_variable_array_append _core_temporaryFiles_filesToRemoveOnExit "$TMP_FILE"
}

core_dependency_requires '*' mktemp
core_temporaryFiles_newFolderToRemoveOnExit()
{
	TMP_FOLDER="$(mktemp -t "$global_ourName".XXXXXXXXXXXX -d)"
	core_variable_array_append _core_temporaryFiles_filesToRemoveOnExit "$TMP_FOLDER"
}
