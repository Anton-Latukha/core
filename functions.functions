core_usesIn core compatibility
core_usesIn core/variable array

core_functions_register()
{
	local functionsVariableName="$1"
	shift 1
	
	core_dependency_declares "$functionsVariableName"
	core_variable_array_append "$functionsVariableName" "$@"
}

core_functions_execute()
{
	local functionsVariableName="$1"
	shift 1
	
	if core_variable_isSet "$functionsVariableName"; then
		core_variable_array_iterateAsCallbacks "$functionsVariableName" "$@"
	fi
}

# Not perfect by any means; an expanded environment variable with content of 'a shell function', say, could fail this test
core_functions_exists()
{
	local functionName="$1"
	if ! type "$functionName" 1>/dev/null 2>/dev/null; then
		return 1
	fi
	
	set -x
	local arg0
	local arg1
	local arg2
	local arg3
	local arg4
	local arg5
	local arg6
	IFS=' ' read -r arg0 arg1 arg2 arg3 arg4 arg5 arg6 <<-EOF
		$(type "$functionName")
	EOF
	echo $arg4
	case "$arg4" in
		
		# dash
		shell)
			if [ "$arg5" = 'function' ]; then
				set +x
				return 0
			fi
		;;
		
		# bash
		function)
				set +x
			return 0
		;;
		
	esac

	set +x
	return 1
}
